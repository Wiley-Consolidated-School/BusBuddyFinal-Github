[DEBUG] BusBuddy Main started at 2025-06-26T05:17:52.5023891-06:00
?? Attempting to acquire single instance lock: Global\BusBuddy_SingleInstance_Mutex_BusBuddy-E7B4F3C1-8A2D-4E5F-9B6C-1D3A5E7F9A2B
? Single instance lock acquired - this is the primary instance
?? BusBuddy starting...
?? License status: Syncfusion Community Edition active
? Syncfusion license is active
?? Initializing BusBuddy theme system...
? Theme system initialized - Office2016 themes available
?? Configuring high DPI support...
? High DPI support configured
?? Named pipe server listening: BusBuddy_Communication_Pipe_BusBuddy-E7B4F3C1-8A2D-4E5F-9B6C-1D3A5E7F9A2B
?? Creating service container...
[PROGRAM] Testing service resolution...
? All services registered successfully
[PROGRAM] DEBUG: Service INavigationService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.NavigationService
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
[PROGRAM] DEBUG: Service IDatabaseHelperService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.Business.DatabaseHelperService
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
[PROGRAM] DEBUG: Service IRouteAnalyticsService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.Business.RouteAnalyticsService
[INFO] 2025-06-26 05:17:53 - ReportService: ReportService initialized with xAI Grok 3 API integration
[PROGRAM] DEBUG: Service IReportService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.ReportService
[PROGRAM] DEBUG: Service IAnalyticsService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.AnalyticsService
[PROGRAM] DEBUG: Service IErrorHandlerService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.ErrorHandlerService
[PROGRAM] ? All services validated
?? Validating required services...
?? Creating Dashboard instance...
? SyncfusionBaseForm: License already registered at application startup
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
? SyncfusionBaseForm: Using pre-registered license for theme initialization
? Applied Office2016Black theme using official ThemeName property
?? Registered form for shutdown: Dashboard
=== ?? DASHBOARD STARTUP SEQUENCE BEGIN ===
[STEP 1] Dashboard constructor START at 05:17:53.413
[STEP 2] Test mode detection: NORMAL MODE
[STEP 2.5] Load event handler attached for final UI setup
[STEP 3] Form closing event handler attached
[STEP 4] Calling InitializeFormProperties()...
  [4.1] Setting form Text property...
  [4.1.5] Configuring High DPI support for 4K graphics...
  [4.1.6] Windows 10+ detected - enabling per-monitor DPI awareness
  [4.2] Checking for windowed mode preference...
  [4.2.3] Using fullscreen mode without borders...
  [4.2.4] ? Fullscreen mode configured
  [4.3] Setting AutoScaleMode to Dpi (already set above)...
  [4.4] Setting BackColor to dark gray...
  [4.5] Setting MinimumSize to 800x600...
  [4.6] ? Form properties initialized with High DPI support and visible background color
[STEP 5] Starting synchronous initialization to prevent white screen issue
[STEP 6] Calling PreInitializeDataStructures()...
[PRE_INIT] Starting data structure initialization...
[PRE_INIT] Adding sample vehicle data...
[PRE_INIT] Adding sample route data...
[PRE_INIT] ? Data structures initialized - Vehicles: 3, Routes: 3
? Data structures pre-initialized with sample data for enhanced visibility
[STEP 7] Calling CreateProperDashboardLayoutSafely()...
  [7.1] ??? Creating dashboard layout with cancellation support
  [7.3] Calling SuspendLayout()...
  [7.4] Clearing existing controls...
  [7.5] Calling InitializeSkinManager()...
? Applied Office2016Black theme using official Syncfusion approaches
  [7.7] Calling CreateHeaderSafely()...
?? Creating header panel using documented Syncfusion controls
? Header panel created successfully using documented Syncfusion controls
  [7.9] Calling InitializeDockingManager()...
    [DockMgr.1] Creating new DockingManager instance...
    [DockMgr.2] ? DockingManager instance created
    [DockMgr.2.1] Setting HostControl to form (DockingManager requires ContainerControl)...
    [DockMgr.2.2] ? HostControl set to Dashboard form
    [DockMgr.3] Setting EnableDocumentMode = true...
    [DockMgr.4] ? EnableDocumentMode set
    [DockMgr.5] Setting CloseTabOnMiddleClick = true...
    [DockMgr.6] ? CloseTabOnMiddleClick set
    [DockMgr.7] Setting ThemeName to 'Office2016Black'...
    [DockMgr.8] ? ThemeName set to Office2016Black
    [DockMgr.9] DockingManager initialized - HostControl: 
    [DockMgr.10] DockingManager container info - Type: DockingManager
    [DockMgr.11] DockingManager host form: 
  [7.11] Creating content panel...
  [7.12] Content panel created and added. Controls count: 8
  [7.12.1] Content panel details - Size: {Width=200, Height=100}, Dock: Fill, Visible: False
  [7.12.2] Form details - Size: {Width=1276, Height=926}, ClientSize: {Width=1276, Height=926}
  [7.14] Calling CreatePanelsWithDynamicLayoutManager()...
    [7.14.1] ?? Starting panel creation using DynamicLayoutManager
    [7.14.2] Checking content panel state before panel operations...
    [7.14.3] Content panel - Exists: True, Visible: False, Size: {Width=200, Height=100}
    [7.14.4] Form control count before panel creation: 8
    [7.14.5] Clearing content panel for new layout...
    [7.14.6] Creating dashboard layout using DynamicLayoutManager...
    [7.14.7] Creating analytics panel with DynamicLayoutManager...
[DynamicLayoutManager] CreateCardLayoutContainer called with parent: Panel 'analyticsPanel'
[DynamicLayoutManager] Parent state - Size: {Width=114, Height=100}, Controls: 0, Visible: False
[DynamicLayoutManager] Created container panel - Size: {Width=200, Height=100}, Dock: Fill
[DynamicLayoutManager] Creating Syncfusion CardLayout...
[DynamicLayoutManager] ? CardLayout created and assigned to container
[DynamicLayoutManager] Adding container to parent 'analyticsPanel'...
[DynamicLayoutManager] Parent controls count before add: 0
[DynamicLayoutManager] ? Container added to parent. Parent controls count after add: 1
[DynamicLayoutManager] Container final state - Size: {Width=112, Height=98}, Parent: analyticsPanel, Visible: False
    [7.14.8] ? Analytics panel created - Size: {Width=114, Height=100}, Visible: False
    [7.14.9] Creating statistics panel with DynamicLayoutManager...
[DynamicLayoutManager] CreateCardLayoutContainer called with parent: Panel 'statisticsPanel'
[DynamicLayoutManager] Parent state - Size: {Width=74, Height=100}, Controls: 0, Visible: False
[DynamicLayoutManager] Created container panel - Size: {Width=200, Height=100}, Dock: Fill
[DynamicLayoutManager] Creating Syncfusion CardLayout...
[DynamicLayoutManager] ? CardLayout created and assigned to container
[DynamicLayoutManager] Adding container to parent 'statisticsPanel'...
[DynamicLayoutManager] Parent controls count before add: 0
[DynamicLayoutManager] ? Container added to parent. Parent controls count after add: 1
[DynamicLayoutManager] Container final state - Size: {Width=72, Height=98}, Parent: statisticsPanel, Visible: False
    [7.14.10] ? Statistics panel created - Size: {Width=74, Height=100}, Visible: False
    [7.14.11] Creating header panel for top row...
    [7.14.12] Performing layout updates...
    [7.14.13] ? Layout created successfully - Content panel control count: 1
    [7.14.14] Analytics panel - Visible: False, Parent: 
    [7.14.15] Statistics panel - Visible: False, Parent: 
    [7.14.16] ? Panel creation with DynamicLayoutManager completed successfully
  [7.16] Calling CreateMainContentSafely()...
    [7.16.1] ??? Starting main content creation using documented Syncfusion controls
    [7.16.2] Creating TabControlAdv...
    [7.16.3] ? TabControlAdv created successfully
    [7.16.4] Creating vehicle tab...
    [7.16.5] Creating routes tab...
    [7.16.6] Creating analytics tab...
    [7.16.7] ? All tabs created successfully
    [7.16.8] Creating vehicles SfDataGrid...
    [7.16.9] ? Vehicles grid created successfully
    [7.16.10] Creating routes SfDataGrid...
    [7.16.11] ? Routes grid created successfully
    [7.16.12] Creating ChartControl...
    [7.16.13] Configuring chart axes...
    [7.16.14] ? ChartControl created and configured successfully
    [7.16.15] Creating RadialGauge...
    [7.16.16] ? RadialGauge created successfully
    [7.16.17] Adding grids to tabs...
    [7.16.18] ? Grids added to tabs successfully
?? BusBuddy theme changed to Office2016White
?? BusBuddy theme changed to Office2016White
    [7.16.19] Creating analytics split container...
    [7.16.20] ? Analytics split container created and populated
    [7.16.21] Adding tabs to TabControlAdv...
    [7.16.22] ? All tabs added. Tab count: 3
    [7.16.23] Adding TabControlAdv to content panel...
    [7.16.24] Content panel info - Size: {Width=200, Height=100}, Controls before: 1
    [7.16.24.1] Setting TabControlAdv.Visible = true...
    [7.16.24.2] Ensuring content panel visibility and sizing...
    [7.16.24.3] Content panel size too small ({Width=200, Height=100}), adjusting...
    [7.16.24.4] Content panel resized to: {Width=1256, Height=846}
    [7.16.25] ? TabControlAdv added to content panel. Controls after: 2
    [7.16.25.1] TabControl final state - Visible: False, Size: {Width=1256, Height=846}, Dock: Fill
    [7.16.25.2] Content panel final state - Visible: False, Size: {Width=1256, Height=846}
    [7.16.26] Checking for cached data to bind...
    [7.16.27] Binding 3 vehicle records...
    [7.16.28] ? Vehicle data bound successfully
    [7.16.29] Binding 3 route records...
    [7.16.30] ? Route data bound successfully
    [7.16.31] ? Main content created successfully with documented Syncfusion controls
  [7.18] Calling ApplyThemesToAllControlsSafely()...
    [THEME.1] ?? Applying themes to all Syncfusion controls...
    [THEME.2] Using theme: Office2016Black
    [THEME.3] ? Themes applied successfully to all Syncfusion controls
  [7.19] ? Dashboard layout created safely with cancellation support
  [7.19.1] FINAL VISIBILITY FIX - Forcing all controls visible...
  [7.19.2] Content panel forced visible: False
  [7.19.3] TabControl forced visible: False
  [7.20] Final control count - Form: 8, Content Panel: 2
  [7.21] Main TabControl - Tab count: 3, Visible: False, Dock: Fill
  [7.23] Calling ResumeLayout(true)...
  [7.24] POST-LAYOUT visibility check and final enforcement...
  [7.24.1] Content panel post-layout - was: False, now: False
  [7.24.2] TabControl post-layout - was: False, now: False
  [7.24.5] Form visibility check - Visible: False, WindowState: Maximized
=== ?? DASHBOARD LOAD EVENT BEGIN ===
[LOAD.1] Form loaded - finalizing visibility checks
[LOAD.2] Content panel visibility enforced: True
[LOAD.3] Tab control visibility enforced: True
[LOAD.4] Analytics panel visibility enforced: True
[LOAD.5] Statistics panel visibility enforced: True
[LOAD.6] ? Dashboard Load event completed successfully
=== ?? DASHBOARD LOAD EVENT END ===
? SyncfusionBaseForm loaded with theme: Office2016Black
? Simple grid theming applied
  [7.24.6] ? Form made visible
  [7.25] ? Enhanced visibility management completed - Dashboard should now be fully visible
[STEP 7.5] Starting async initialization for complex components...
?? Starting enhanced dashboard initialization with cancellation support
?? Pre-initializing data with cancellation support
[PRE_INIT] Starting data structure initialization...
[STEP 8] ? Dashboard constructor COMPLETE at 05:17:54.589
[PRE_INIT] Adding sample vehicle data...
[LOG ERROR] [PRE_INIT] Adding sample vehicle data... (File logging failed: The process cannot access the file 'C:\Users\steve.mckitrick\Desktop\BusBuddy\dashboard_startup_20250626_051753.log' because it is being used by another process.)
[PRE_INIT] Adding sample route data...
=== ?? DASHBOARD STARTUP SEQUENCE END ===
[LOG ERROR] === ?? DASHBOARD STARTUP SEQUENCE END === (File logging failed: The process cannot access the file 'C:\Users\steve.mckitrick\Desktop\BusBuddy\dashboard_startup_20250626_051753.log' because it is being used by another process.)
? Dashboard created successfully
[PRE_INIT] ? Data structures initialized - Vehicles: 3, Routes: 3
?? Running application...
? Data structures pre-initialized with sample data for enhanced visibility
  [7.1] ??? Creating dashboard layout with cancellation support
  [7.3] Calling SuspendLayout()...
  [7.4] Clearing existing controls...
  [7.5] Calling InitializeSkinManager()...
? Applied Office2016Black theme using official Syncfusion approaches
  [7.7] Calling CreateHeaderSafely()...
?? Creating header panel using documented Syncfusion controls
? Header panel created successfully using documented Syncfusion controls
  [7.9] Calling InitializeDockingManager()...
    [DockMgr.1] Creating new DockingManager instance...
    [DockMgr.2] ? DockingManager instance created
    [DockMgr.2.1] Setting HostControl to form (DockingManager requires ContainerControl)...
    [DockMgr.2.2] ? HostControl set to Dashboard form
    [DockMgr.3] Setting EnableDocumentMode = true...
    [DockMgr.4] ? EnableDocumentMode set
    [DockMgr.5] Setting CloseTabOnMiddleClick = true...
    [DockMgr.6] ? CloseTabOnMiddleClick set
    [DockMgr.7] Setting ThemeName to 'Office2016Black'...
    [DockMgr.8] ? ThemeName set to Office2016Black
    [DockMgr.9] DockingManager initialized - HostControl: 
    [DockMgr.10] DockingManager container info - Type: DockingManager
    [DockMgr.11] DockingManager host form: 
  [7.11] Creating content panel...
  [7.12] Content panel created and added. Controls count: 8
  [7.12.1] Content panel details - Size: {Width=200, Height=100}, Dock: Fill, Visible: True
  [7.12.2] Form details - Size: {Width=1920, Height=1080}, ClientSize: {Width=1920, Height=1080}
  [7.14] Calling CreatePanelsWithDynamicLayoutManager()...
    [7.14.1] ?? Starting panel creation using DynamicLayoutManager
    [7.14.2] Checking content panel state before panel operations...
    [7.14.3] Content panel - Exists: True, Visible: True, Size: {Width=200, Height=100}
    [7.14.4] Form control count before panel creation: 8
    [7.14.5] Clearing content panel for new layout...
    [7.14.6] Creating dashboard layout using DynamicLayoutManager...
    [7.14.7] Creating analytics panel with DynamicLayoutManager...
[DynamicLayoutManager] CreateCardLayoutContainer called with parent: Panel 'analyticsPanel'
[DynamicLayoutManager] Parent state - Size: {Width=114, Height=100}, Controls: 0, Visible: True
[DynamicLayoutManager] Created container panel - Size: {Width=200, Height=100}, Dock: Fill
[DynamicLayoutManager] Creating Syncfusion CardLayout...
[DynamicLayoutManager] ? CardLayout created and assigned to container
[DynamicLayoutManager] Adding container to parent 'analyticsPanel'...
[DynamicLayoutManager] Parent controls count before add: 0
[DynamicLayoutManager] ? Container added to parent. Parent controls count after add: 1
[DynamicLayoutManager] Container final state - Size: {Width=112, Height=98}, Parent: analyticsPanel, Visible: True
    [7.14.8] ? Analytics panel created - Size: {Width=114, Height=100}, Visible: True
    [7.14.9] Creating statistics panel with DynamicLayoutManager...
[DynamicLayoutManager] CreateCardLayoutContainer called with parent: Panel 'statisticsPanel'
[DynamicLayoutManager] Parent state - Size: {Width=74, Height=100}, Controls: 0, Visible: True
[DynamicLayoutManager] Created container panel - Size: {Width=200, Height=100}, Dock: Fill
[DynamicLayoutManager] Creating Syncfusion CardLayout...
[DynamicLayoutManager] ? CardLayout created and assigned to container
[DynamicLayoutManager] Adding container to parent 'statisticsPanel'...
[DynamicLayoutManager] Parent controls count before add: 0
[DynamicLayoutManager] ? Container added to parent. Parent controls count after add: 1
[DynamicLayoutManager] Container final state - Size: {Width=72, Height=98}, Parent: statisticsPanel, Visible: True
    [7.14.10] ? Statistics panel created - Size: {Width=74, Height=100}, Visible: True
    [7.14.11] Creating header panel for top row...
    [7.14.12] Performing layout updates...
    [7.14.13] ? Layout created successfully - Content panel control count: 1
    [7.14.14] Analytics panel - Visible: True, Parent: 
    [7.14.15] Statistics panel - Visible: True, Parent: 
    [7.14.16] ? Panel creation with DynamicLayoutManager completed successfully
  [7.16] Calling CreateMainContentSafely()...
    [7.16.1] ??? Starting main content creation using documented Syncfusion controls
    [7.16.2] Creating TabControlAdv...
    [7.16.3] ? TabControlAdv created successfully
    [7.16.4] Creating vehicle tab...
    [7.16.5] Creating routes tab...
    [7.16.6] Creating analytics tab...
    [7.16.7] ? All tabs created successfully
    [7.16.8] Creating vehicles SfDataGrid...
    [7.16.9] ? Vehicles grid created successfully
    [7.16.10] Creating routes SfDataGrid...
    [7.16.11] ? Routes grid created successfully
    [7.16.12] Creating ChartControl...
    [7.16.13] Configuring chart axes...
    [7.16.14] ? ChartControl created and configured successfully
    [7.16.15] Creating RadialGauge...
    [7.16.16] ? RadialGauge created successfully
    [7.16.17] Adding grids to tabs...
    [7.16.18] ? Grids added to tabs successfully
?? BusBuddy theme changed to Office2016White
?? BusBuddy theme changed to Office2016White
    [7.16.19] Creating analytics split container...
    [7.16.20] ? Analytics split container created and populated
    [7.16.21] Adding tabs to TabControlAdv...
    [7.16.22] ? All tabs added. Tab count: 3
    [7.16.23] Adding TabControlAdv to content panel...
    [7.16.24] Content panel info - Size: {Width=200, Height=100}, Controls before: 1
    [7.16.24.1] Setting TabControlAdv.Visible = true...
    [7.16.24.2] Ensuring content panel visibility and sizing...
    [7.16.24.3] Content panel size too small ({Width=200, Height=100}), adjusting...
    [7.16.24.4] Content panel resized to: {Width=1900, Height=1000}
    [7.16.25] ? TabControlAdv added to content panel. Controls after: 2
    [7.16.25.1] TabControl final state - Visible: True, Size: {Width=1900, Height=1000}, Dock: Fill
    [7.16.25.2] Content panel final state - Visible: True, Size: {Width=1900, Height=1000}
    [7.16.26] Checking for cached data to bind...
    [7.16.27] Binding 3 vehicle records...
    [7.16.28] ? Vehicle data bound successfully
    [7.16.29] Binding 3 route records...
    [7.16.30] ? Route data bound successfully
    [7.16.31] ? Main content created successfully with documented Syncfusion controls
  [7.18] Calling ApplyThemesToAllControlsSafely()...
    [THEME.1] ?? Applying themes to all Syncfusion controls...
    [THEME.2] Using theme: Office2016Black
    [THEME.3] ? Themes applied successfully to all Syncfusion controls
  [7.19] ? Dashboard layout created safely with cancellation support
  [7.19.1] FINAL VISIBILITY FIX - Forcing all controls visible...
  [7.19.2] Content panel forced visible: True
  [7.19.3] TabControl forced visible: True
  [7.20] Final control count - Form: 8, Content Panel: 2
  [7.21] Main TabControl - Tab count: 3, Visible: True, Dock: Fill
  [7.23] Calling ResumeLayout(true)...
  [7.24] POST-LAYOUT visibility check and final enforcement...
  [7.24.1] Content panel post-layout - was: True, now: True
  [7.24.2] TabControl post-layout - was: True, now: True
  [7.24.5] Form visibility check - Visible: True, WindowState: Maximized
  [7.25] ? Enhanced visibility management completed - Dashboard should now be fully visible
? Loading indicator hidden
? Async dashboard initialization completed successfully
? Close button clicked - initiating clean shutdown
[CLOSE_BUTTON] User clicked close button - starting clean shutdown
?? SyncfusionBaseForm closing: Dashboard
?? Cleaned up Syncfusion control: FocusHolder
?? Cleaned up Syncfusion control: ScrollButtons
?? Cleaned up Syncfusion control: AHTabControl
?? Cleaned up Syncfusion control: ScrollButtons
?? Cleaned up Syncfusion control: AHTabControl
?? Cleaned up Syncfusion control: ScrollButtons
?? Cleaned up Syncfusion control: AHTabControl
?? Cleaned up Syncfusion control: ScrollButtons
?? Cleaned up Syncfusion control: AHTabControl
?? Cleaned up Syncfusion control: SfButton
?? Cleaned up Syncfusion control: SfButton
?? Cleaned up Syncfusion control: SfButton
?? Cleaned up Syncfusion control: RadialGauge
?? Cleaned up Syncfusion control: ChartLegend
?? Cleaned up Syncfusion control: ChartToolBar
?? ChartControl cleaned up safely
?? Cleaned up Syncfusion control: ChartControl
?? Cleaned up Syncfusion control: TabPageAdv
?? Cleaned up Syncfusion control: SfListView
?? Cleaned up Syncfusion control: GroupPanel
?? Cleaned up Syncfusion control: TableControl
?? Cleaned up Syncfusion control: SfDataGrid
?? Cleaned up Syncfusion control: TabPageAdv
?? Cleaned up Syncfusion control: SfListView
?? Cleaned up Syncfusion control: GroupPanel
?? Cleaned up Syncfusion control: TableControl
?? Cleaned up Syncfusion control: SfDataGrid
?? Cleaned up Syncfusion control: TabPageAdv
?? Cleaned up Syncfusion control: ScrollButtons
?? Cleaned up Syncfusion control: TabControlAdv
? SyncfusionBaseForm cleanup completed: Dashboard
?? Dashboard initialization canceled
?? Dashboard closing - canceling pending operations
??? Dashboard dispose starting - disposing Syncfusion controls safely
[DISPOSE] Starting comprehensive resource cleanup
[CACHE.CLEAR] Clearing cached data...
[CACHE.CLEAR] ? Cached data cleared successfully
[DISPOSE.1] Disposing SfButton controls...
[DISPOSE.2] Disposing SfDataGrid controls...
[DISPOSE.3] Disposing chart and gauge controls...
[DISPOSE.4] Disposing TabControlAdv...
[DISPOSE.5] Disposing ComboBoxAdv...
[DISPOSE.6] Disposing DockingManager...
[DISPOSE.7] Disposing panel controls...
[DISPOSE.8] Disposing loading indicator...
[DISPOSE.9] Clearing form controls...
[DISPOSE.10] Forcing garbage collection...
[DISPOSE.11] ? Comprehensive resource cleanup completed
? Syncfusion controls disposed safely using documented methods
?? Releasing single instance lock
? Single instance lock released
?? Application exited after main form closed
?? Application cleanup complete, exiting.
[DEBUG] Process exit/unloading at 2025-06-26T05:18:00.5644647-06:00

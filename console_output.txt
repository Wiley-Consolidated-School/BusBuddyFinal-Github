[DEBUG] BusBuddy Main started at 2025-06-26T19:45:38.8289588-06:00
?? Attempting to acquire single instance lock: Global\BusBuddy_SingleInstance_Mutex_BusBuddy-E7B4F3C1-8A2D-4E5F-9B6C-1D3A5E7F9A2B
? Single instance lock acquired - this is the primary instance
?? BusBuddy starting...
?? License status: Syncfusion Community Edition active
? Syncfusion license is active
?? Initializing BusBuddy theme system...
? Theme system initialized - Office2016 themes available
?? Configuring high DPI support...
?? Named pipe server listening: BusBuddy_Communication_Pipe_BusBuddy-E7B4F3C1-8A2D-4E5F-9B6C-1D3A5E7F9A2B
? High DPI support configured
?? Creating service container...
[PROGRAM] Testing service resolution...
? All services registered successfully
[PROGRAM] DEBUG: Service INavigationService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.NavigationService
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
[PROGRAM] DEBUG: Service IDatabaseHelperService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.Business.DatabaseHelperService
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
[PROGRAM] DEBUG: Service IRouteAnalyticsService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.Business.RouteAnalyticsService
[INFO] 2025-06-26 19:45:39 - ReportService: ReportService initialized with xAI Grok 3 API integration
[PROGRAM] DEBUG: Service IReportService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.ReportService
[PROGRAM] DEBUG: Service IAnalyticsService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.AnalyticsService
[PROGRAM] DEBUG: Service IErrorHandlerService resolved: Success
[PROGRAM] DEBUG: Service type: BusBuddy.UI.Services.ErrorHandlerService
[PROGRAM] ? All services validated
?? Validating required services...
?? Creating Dashboard instance...
? SyncfusionBaseForm: License already registered at application startup
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
Using configured connection string
? Database connection successful
? SyncfusionBaseForm: Using pre-registered license for theme initialization
? Applied Office2016Black theme using official ThemeName property
?? Registered form for shutdown: Dashboard
=== ?? DASHBOARD STARTUP SEQUENCE BEGIN ===
[STEP 1] Dashboard constructor START at 19:45:39.550
[STEP 2] Test mode detection: NORMAL MODE
[STEP 2.5] Load event handler attached for final UI setup
[STEP 3] Form closing event handler attached
[STEP 4] Calling InitializeFormProperties()...
  [4.1] Setting form Text property...
  [4.1.5] Configuring High DPI support for 4K graphics...
  [4.1.6] Windows 10+ detected - enabling per-monitor DPI awareness
  [4.2] Checking for windowed mode preference...
  [4.2.1] Setting form size to 1400x900...
  [4.2.2] ? Form configured with size 1400x900, centered, no taskbar overlap
  [4.3] Setting AutoScaleMode to Dpi (already set above)...
  [4.4] Setting BackColor to dark gray...
  [4.5] Setting MinimumSize to 800x600...
  [4.6] ? Form properties initialized with High DPI support and visible background color
[STEP 5] Starting synchronous initialization to prevent white screen issue
[STEP 6] Calling PreInitializeDataStructures()...
[PRE_INIT] Starting data structure initialization...
[PRE_INIT] Adding sample vehicle data...
[PRE_INIT] Adding sample route data...
[PRE_INIT] ? Data structures initialized - Vehicles: 3, Routes: 3
? Data structures pre-initialized with sample data for enhanced visibility
[STEP 7] Calling CreateProperDashboardLayoutSafely()...
  [7.1] ??? Creating new dashboard layout (1400x900) with DockingManager.Fill
  [7.3] Calling SuspendLayout()...
  [7.4] Clearing existing controls...
  [7.5] Initializing MaterialDark theme...
    [THEME.1] Applying MaterialDark theme to form...
    [THEME.2] ? MaterialDark theme applied successfully
  [7.7] Initializing DockingManager for Fill layout...
    [DOCK.1] Creating DockingManager for Fill layout...
    [DOCK.ERROR] ? Error creating DockingManager: Index was out of range. Must be non-negative and less than the size of the collection. (Parameter 'index')
  [7.9] Creating left TreeView navigation (200px)...
    [NAV.1] Creating left navigation TreeView (200px)...
    [NAV.2] ?? Navigation TreeView added directly (DockingManager unavailable)
    [NAV.3] ? Left navigation TreeView created - Size: {Width=200, Height=851}
  [7.11] Creating main content panel with Fill docking...
    [CONTENT.1] Creating main content panel with Fill docking...
    [CONTENT.2] ?? Main content panel added directly (DockingManager unavailable)
    [CONTENT.3] ? Main content panel created - Size: {Width=200, Height=100}
  [7.13] Creating top TabControl with Map, Statistics, Analytics tabs...
    [TAB.1] Creating TabControl with Map, Statistics, Analytics tabs...
    [TAB.2] ? TabControl added to main content panel
    [TAB.3] ? TabControl created with 3 tabs
  [7.15] Configuring MapControl with sample school routes...
    [MAP.1] Configuring MapControl with sample school routes...
    [MAP.SAMPLE.1] Creating sample school route markers...
    [MAP.SAMPLE.2] ? Sample school route markers created
    [MAP.2] ? MapControl configured with sample school routes
  [7.17] Configuring ChartControl for fuel statistics...
    [CHART.1] Configuring ChartControl for fuel statistics...
    [CHART.SAMPLE.1] Creating sample fuel statistics data...
    [CHART.SAMPLE.2] ? Sample fuel statistics data created
    [CHART.2] ? ChartControl configured for fuel statistics
  [7.19] Configuring SfDataGrid for analytics data...
    [GRID.1] Configuring SfDataGrid for analytics data...
    [GRID.SAMPLE.1] Creating sample analytics data...
    [GRID.SAMPLE.2] ? Sample analytics data created (30 records)
    [GRID.2] ? SfDataGrid configured for analytics data
  [7.21] Enabling close button and finalizing layout...
  [7.22] ? New dashboard layout created successfully with DockingManager.Fill
  [7.19.3] TabControl forced visible: False
  [7.20] Final control count - Form: 2, Content Panel: 1
  [7.21] Main TabControl - Tab count: 3, Visible: False, Dock: Fill
  [7.23] Calling ResumeLayout(true)...
  [7.24] POST-LAYOUT visibility check and final enforcement...
  [7.24.1] Content panel post-layout - was: False, now: False
  [7.24.2] TabControl post-layout - was: False, now: False
  [7.24.5] Form visibility check - Visible: False, WindowState: Normal
=== ?? DASHBOARD LOAD EVENT BEGIN ===
[LOAD.1] Form loaded - finalizing visibility checks
[LOAD.2] Content panel visibility enforced: True
[LOAD.3] Tab control visibility enforced: True
[LOAD.6] ? Dashboard Load event completed successfully
=== ?? DASHBOARD LOAD EVENT END ===
? SyncfusionBaseForm loaded with theme: Office2016Black
? Simple grid theming applied
    [NAV.SELECT] Navigation selected: management
  [7.24.6] ? Form made visible
  [7.25] ? Enhanced visibility management completed - Dashboard should now be fully visible
[STEP 7.5] Starting async initialization for complex components...
?? Starting enhanced dashboard initialization with cancellation support
?? Pre-initializing data with cancellation support
[PRE_INIT] Starting data structure initialization...
[STEP 8] ? Dashboard constructor COMPLETE at 19:45:40.833
[LOG ERROR] [STEP 8] ? Dashboard constructor COMPLETE at 19:45:40.833 (File logging failed: The process cannot access the file 'C:\Users\steve.mckitrick\Desktop\BusBuddy\dashboard_startup_20250626_194539.log' because it is being used by another process.)
=== ?? DASHBOARD STARTUP SEQUENCE END ===
[PRE_INIT] Adding sample vehicle data...
[LOG ERROR] [PRE_INIT] Adding sample vehicle data... (File logging failed: The process cannot access the file 'C:\Users\steve.mckitrick\Desktop\BusBuddy\dashboard_startup_20250626_194539.log' because it is being used by another process.)
[PRE_INIT] Adding sample route data...
? Dashboard created successfully
?? Running application...
[PRE_INIT] ? Data structures initialized - Vehicles: 3, Routes: 3
? Data structures pre-initialized with sample data for enhanced visibility
  [7.1] ??? Creating new dashboard layout (1400x900) with DockingManager.Fill
  [7.3] Calling SuspendLayout()...
  [7.4] Clearing existing controls...
  [7.5] Initializing MaterialDark theme...
    [THEME.1] Applying MaterialDark theme to form...
    [THEME.2] ? MaterialDark theme applied successfully
  [7.7] Initializing DockingManager for Fill layout...
    [DOCK.1] Creating DockingManager for Fill layout...
    [DOCK.ERROR] ? Error creating DockingManager: Index was out of range. Must be non-negative and less than the size of the collection. (Parameter 'index')
  [7.9] Creating left TreeView navigation (200px)...
    [NAV.1] Creating left navigation TreeView (200px)...
    [NAV.2] ?? Navigation TreeView added directly (DockingManager unavailable)
    [NAV.3] ? Left navigation TreeView created - Size: {Width=200, Height=851}
  [7.11] Creating main content panel with Fill docking...
    [CONTENT.1] Creating main content panel with Fill docking...
    [CONTENT.2] ?? Main content panel added directly (DockingManager unavailable)
    [CONTENT.3] ? Main content panel created - Size: {Width=200, Height=100}
  [7.13] Creating top TabControl with Map, Statistics, Analytics tabs...
    [TAB.1] Creating TabControl with Map, Statistics, Analytics tabs...
    [TAB.2] ? TabControl added to main content panel
    [TAB.3] ? TabControl created with 3 tabs
  [7.15] Configuring MapControl with sample school routes...
    [MAP.1] Configuring MapControl with sample school routes...
    [MAP.SAMPLE.1] Creating sample school route markers...
    [MAP.SAMPLE.2] ? Sample school route markers created
    [MAP.2] ? MapControl configured with sample school routes
  [7.17] Configuring ChartControl for fuel statistics...
    [CHART.1] Configuring ChartControl for fuel statistics...
    [CHART.SAMPLE.1] Creating sample fuel statistics data...
    [CHART.SAMPLE.2] ? Sample fuel statistics data created
    [CHART.2] ? ChartControl configured for fuel statistics
  [7.19] Configuring SfDataGrid for analytics data...
    [GRID.1] Configuring SfDataGrid for analytics data...
    [GRID.SAMPLE.1] Creating sample analytics data...
    [GRID.SAMPLE.2] ? Sample analytics data created (30 records)
    [GRID.2] ? SfDataGrid configured for analytics data
  [7.21] Enabling close button and finalizing layout...
  [7.22] ? New dashboard layout created successfully with DockingManager.Fill
  [7.19.3] TabControl forced visible: True
  [7.20] Final control count - Form: 2, Content Panel: 1
  [7.21] Main TabControl - Tab count: 3, Visible: True, Dock: Fill
  [7.23] Calling ResumeLayout(true)...
  [7.24] POST-LAYOUT visibility check and final enforcement...
  [7.24.1] Content panel post-layout - was: True, now: True
  [7.24.2] TabControl post-layout - was: True, now: True
  [7.24.5] Form visibility check - Visible: True, WindowState: Normal
  [7.25] ? Enhanced visibility management completed - Dashboard should now be fully visible
? Loading indicator hidden
? Async dashboard initialization completed successfully
?? Received connection from secondary instance
    [NAV.SELECT] Navigation selected: management
?? Received arguments from secondary instance: []
?? Secondary instance detected with args: []
? Brought main window to front
?? Named pipe server listening: BusBuddy_Communication_Pipe_BusBuddy-E7B4F3C1-8A2D-4E5F-9B6C-1D3A5E7F9A2B
?? SyncfusionBaseForm closing: Dashboard
?? Cleaned up Syncfusion control: GroupPanel
?? Cleaned up Syncfusion control: SizeGrip
?? Cleaned up Syncfusion control: VerticalScrollBar
?? Cleaned up Syncfusion control: TableControl
?? Cleaned up Syncfusion control: SfDataGrid
?? Cleaned up Syncfusion control: TabPageAdv
?? Cleaned up Syncfusion control: ChartLegend
?? Cleaned up Syncfusion control: ChartToolBar
?? ChartControl cleaned up safely
?? Cleaned up Syncfusion control: ChartControl
?? Cleaned up Syncfusion control: TabPageAdv
?? Cleaned up Syncfusion control: Maps
?? Cleaned up Syncfusion control: TabPageAdv
?? Cleaned up Syncfusion control: ScrollButtons
?? Cleaned up Syncfusion control: TabControlAdv
? SyncfusionBaseForm cleanup completed: Dashboard
?? Dashboard initialization canceled
?? Dashboard closing - canceling pending operations
??? Dashboard dispose starting - disposing Syncfusion controls safely
[DISPOSE] Starting comprehensive resource cleanup
[CACHE.CLEAR] Clearing cached data...
[CACHE.CLEAR] ? Cached data cleared successfully
[DISPOSE.1] Disposing SfButton controls...
[DISPOSE.2] Disposing SfDataGrid controls...
[DISPOSE.3] Disposing chart and gauge controls...
[DISPOSE.4] Disposing TabControlAdv...
[DISPOSE.5] Disposing ComboBoxAdv...
[DISPOSE.6] Disposing DockingManager...
[DISPOSE.7] Disposing panel controls...
[DISPOSE.8] Disposing loading indicator...
[DISPOSE.9] Clearing form controls...
[DISPOSE.10] Forcing garbage collection...
[DISPOSE.11] ? Comprehensive resource cleanup completed
? Syncfusion controls disposed safely using documented methods
?? Releasing single instance lock
? Single instance lock released
?? Application exited after main form closed
?? Application cleanup complete, exiting.
[DEBUG] Process exit/unloading at 2025-06-26T19:45:57.3915370-06:00
